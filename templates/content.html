
{% if folders %}
<span class="badge text-muted mb-1 mt-4">Folders</span>
<div class="drive-wrapper drive-grid-view collapse_grid" id="collapse_grid">
    <div class="grid-items-wrapper">
      <div id="main-content" class="file_manager">
              <div class="container-fluid">
                  <div class="row clearfix">
                        {% for folder in folders %}
                          <div class="col-lg-3 col-md-4 col-sm-12">
                          <div class="card">
                              <div class="file">
                                <div class="show_settings">
                                  <div class="hover">
                                    <h4><a href="{% url 'folder:delete_folder' folder.unique_id %}" data-toggle="tooltip" data-placement="top" title="" data-original-title="Delete Folder"><i class="lni lni-trash-can delete icons"></i></a></h4>
                                  </div>
                                </div>
                                  <a href="{% url 'folder:folder' folder.unique_id %}">
                                      <div class="icon">
                                          <i class="fa fa-folder text-primary folder-icon" ></i>
                                      </div>
                                      <div class="file-name">
                                          <a title="{{ folder.name }}" href="{% url 'folder:folder' folder.unique_id %}"><p class="m-b-5 text-muted">{{ folder.name }}</p></a>
                                          <small>Files: {{folder.get_files_count}} <span class="date text-muted">{{folder.created_at}}</span></small>
                                      </div>
                                  </a>
                              </div>
                          </div>
                      </div>
                        {% endfor %}
                  </div>
              </div>
          </div>
    </div>
</div>
<div class="drive-wrapper drive-list-view d-none collapse_list" id="collapse_list">
    <div class="table-responsive drive-items-table-wrapper">
        {% if folders %}

          <table class="table">
              <thead>
                  <tr>
                      <th class="type"></th>
                      <th class="name truncate">Name</th>
                      <th class="date">Uploaded</th>
                      <th class="size">Delete</th>
                  </tr>
              </thead>
              <tbody>
                  {% for folder in folders %}
                  <tr>
                      <td class="type">
                        <i class="fa fa-folder text-primary "></i>
                      </td>
                      <td class="name truncate"><a href="{% url 'folder:folder' folder.unique_id %}">{{folder.name|truncatechars:35}}</a></td>
                      <td class="date">{{folder.created_at}}</td>
                      <td class="center"><a href="{% url 'folder:delete_folder' folder.unique_id %}" class="delete" data-toggle="tooltip" data-placement="top" title="" data-original-title="Delete"><i class="lni lni-trash-can delete"></i></a></td>
                  </tr>
                  {% endfor %}

              </tbody>
          </table>
          {% endif %}
    </div>
</div>
{% endif %}

{% if files %}
<span class="badge text-muted mb-1 mt-4">Files</span>
<div class="drive-wrapper drive-grid-view collapse_grid" id="collapse_grid">
    <div class="grid-items-wrapper">
      <div id="main-content" class="file_manager">
              <div class="container-fluid">
                  <div class="row clearfix">
                      {% for file in files %}
                      <div class="col-lg-3 col-md-4 col-sm-12">
                          <div class="card">
                              <div class="file">
                                <div class="show_settings">
                                  <div class="file_settings">
                                    <h4><a href="{% url 'file:file_settings' file.unique_id %}" data-toggle="tooltip" data-placement="top" title="" data-original-title="Sharing Settings"><i class="lni lni-users share icons"></i></a></h4>
                                  </div>
                                  <div class="hover">
                                    <h4><a id="link-{{file.unique_id}}" href="javascript:void(0)" data-toggle="tooltip" data-placement="top" title="" data-original-title="Copy Link"><i onclick="CopyFileLink('{{ file.get_url }}', 'link-{{file.unique_id}}')" class="lni lni-link copy icons"></i></a></h4>
                                    <h4><a href="{% url 'download' file.privacy.link %}" download data-toggle="tooltip" data-placement="top" title="" data-original-title="Download"><i class="lni lni-arrow-down-circle download icons"></i></a></h4>
                                    <h4><a href="{% url 'file:move_to_trash' file.unique_id %}" data-toggle="tooltip" data-placement="top" title="" data-original-title="Move To Trash"><i class="lni lni-trash-can delete icons"></i></a></h4>
                                  </div>
                                </div>
                                  <a href="{{file.get_url}}" target="_blank">

                                      <div class="icon">
                                           {% if file.file_category == 'images' %}
                                            <i class="fa fa-file-image-o text-primary"></i>
                                          {% elif file.file_category == 'docs' %}
                                            <i class="fa fa-file-text-o text-success"></i>
                                          {% elif file.file_category == 'media' %}
                                            <i class="fa fa-file-video-o text-danger"></i>
                                          {% elif file.file_category == 'zip' %}
                                            <i class="fa fa-file-archive-o text-warning"></i>
                                          {% else %}
                                            <i class="fa fa-file text-info"></i>
                                          {% endif %}

                                      </div>
                                      <div class="file-name">
                                          <a title="{{ file.file_name }}" href="{{file.get_url}}" target="_blank"><p class="m-b-5 text-muted">{{file.file_name|truncatechars:35}}</p></a>
                                          <small>Size: {{file.file_size|filesizeformat}} <span class="date text-muted">{{file.uploaded_at}}</span></small>
                                      </div>
                                  </a>
                              </div>
                          </div>
                      </div>
                      {% endfor %}
                  </div>

              </div>
          </div>

    </div>
</div>
<div class="drive-wrapper drive-list-view d-none collapse_list" id="collapse_list">
    <div class="table-responsive drive-items-table-wrapper">
      {% if files %}

        <table class="table">
            <thead>
                <tr>
                    <th class="type"></th>
                    <th class="name truncate">Name</th>
                    <th class="date">Uploaded</th>
                    <th class="size">Size</th>
                    <th class="size">Copy Link</th>
                    <th class="size">Download</th>
                    <th class="size">Trash</th>
                </tr>
            </thead>
            <tbody>
                {% for file in files %}
                <tr>
                    <td class="type">
                      {% if file.file_category == 'images' %}
                        <i class="fa fa-file-image-o text-primary"></i>
                      {% elif file.file_category == 'docs' %}
                        <i class="fa fa-file-text-o text-success"></i>
                      {% elif file.file_category == 'media' %}
                        <i class="fa fa-file-video-o text-danger"></i>
                      {% elif file.file_category == 'zip' %}
                        <i class="fa fa-file-archive-o text-warning"></i>
                      {% else %}
                        <i class="fa fa-file text-info"></i>
                      {% endif %}
                    </td>
                    <td class="name truncate"><a title="{{ file.file_name }}" href="{{file.get_url}}" target="_blank">{{file.file_name|truncatechars:35}}</a></td>
                    <td class="date">{{file.uploaded_at}}</td>
                    <td class="size">{{file.file_size|filesizeformat}}</td>
                    <td class="center"><a id="link-{{file.unique_id}}" class="copy" href="javascript:void(0)" data-toggle="tooltip" data-placement="top" title="" data-original-title="Copy Link"><i onclick="CopyFileLink('{{ file.get_url }}', 'link-{{file.unique_id}}')" class="lni lni-link"></i></a></td>
                    <td class="center"><a href="{% url 'download' file.privacy.link %}" class="download" data-toggle="tooltip" data-placement="top" title="" data-original-title="Download" download><i class="lni lni-arrow-down-circle download"></i></a></td>
                    <td class="center"><a href="{% url 'file:move_to_trash' file.unique_id %}" class="delete" data-toggle="tooltip" data-placement="top" title="" data-original-title="Move To Trash"><i class="lni lni-trash-can delete"></i></a></td>
                </tr>
                {% endfor %}

            </tbody>
        </table>
        {% endif %}
    </div>
</div>
{% endif %}

{% if files %}
  {% include 'file/files_paginator.html' with files=files %}
{% endif %}

{% if not files and not folders %}
<div class="drive-wrapper drive-grid-view collapse_grid" id="collapse_grid">
    <div class="grid-items-wrapper">
      <div id="main-content" class="file_manager">
              <div class="container-fluid">
                  <div class="row clearfix">
                      {% include 'file/no_files_found.html' %}
                  </div>

              </div>
          </div>

    </div>
</div>
{% endif %}

<script type="text/javascript">
  function CopyFileLink(link, id)  {
      const file_id = document.getElementById(id);
      const el = document.createElement('textarea');
      el.value = link;
      document.body.appendChild(el);
      el.select();
      document.execCommand('copy');
      document.body.removeChild(el);
      file_id.style.display = "none";
      file_id.setAttribute('data-original-title', 'Copied!')
      setTimeout(function(){
        file_id.style.display = "block";
      }, 0);

      setTimeout(function(){
        file_id.setAttribute('data-original-title', 'Copy Link')
      }, 500);

    };

    const grid_toggle = document.getElementById('drive-grid-toggle');
    const list_toggle = document.getElementById('drive-list-toggle');

    grid_toggle.addEventListener('click', (e) => {
      $(".collapse_list").addClass('d-none');
      $(".collapse_grid").removeClass("d-none");
      anime({
        targets: '.collapse_grid',
        translateY: 10,
        direction: 'alternate',
        easing: 'spring(1, 80, 10, 0)'
      })

      anime({
        targets: '.collapse_list',
        translateY: 0,
        direction: 'alternate',
        easing: 'spring(1, 80, 10, 0)'
      })
    });




    list_toggle.addEventListener('click', (e) => {
      $(".collapse_grid").addClass("d-none");
      $(".collapse_list").removeClass("d-none");

      anime({
        targets: '.collapse_grid',
        translateY: 0,
        direction: 'alternate',
        easing: 'spring(1, 80, 10, 0)'
      })

      anime({
        targets: '.collapse_list',
        translateY: 10,
        direction: 'alternate',
        easing: 'spring(1, 80, 10, 0)'
      })
    });

</script>
